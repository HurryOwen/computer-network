# 域名的解析
域名最右边的称为**顶级域名**，如“com”，“edu”，"cn"，"org"等，往左依次是二级域名、三级域名等等。

**域名解析系统(DNS)**就是把域名解析成 IP。
DNS 的核心是一个三层的树状、分布式服务，基本对应域名的结构：
- 根域名服务器：管理顶级域名服务器，返回“com”，“net”，“cn”等顶级服务器的地址；
- 顶级域名服务器：管理各自域名下的权威域名服务器，比如 com 顶级域名可以返回 apple.com 域名服务器的 IP 地址。
- 权威域名服务器：管理自己域名下主机的 IP 地址，比如 apple.com 权威域名服务其可以返回 www.apple.com 的 IP 地址

在这里根域名服务器很关键，它必须是众所周知的。

核心 DNS 之外，还有两种手段来减轻域名解析的压力，并更快地获取结果，基本思路就是缓存：
- 非权威域名服务器，如 google 的 8.8.8.8，microsoft 的 4.2.2.1 等
- 操作系统本身对 DNS 解析结果做缓存，另外还有 `hosts` 文件

![域名解析](https://static001.geekbang.org/resource/image/e5/ac/e51df3245609880641043af65bba94ac.png)


> 请求过程为：
浏览器缓存->操作系统dnscache ->hosts文件->非权威域名服务器->根域名服务器->顶级域名服务器->二级域名服务器->权威域名服务器。

# 域名的新玩法
- 重定向，当主机的 IP 地址有变动时，可以更改 DNS 记录，让域名指向其他的机器。
- 因为域名是一个名字空间，所以可以使用 bind9 等开源软件搭建一个内部使用的 DNS，作为名字服务器。这样我们开发的各种内部服务就都用域名来标记，比如数据库服务都用域名“mysql.inner.app”，商品服务都用“goods.inner.app”，发起网络通信时也就不必再使用写死的 IP 地址了，可以直接用域名。
- 基于域名实现的负载均衡。有两种方式：
    - 因为域名解析可以返回多个 IP 地址，所以一个域名可以对应多台主机，客户端收到多个 IP 后，可以自己使用轮询算法依次向各个 IP 地址发起请求，实现负载均衡。
    - 域名解析可以配置内部的策略，返回离客户端最近的主机，或返回当前服务质量最好的主机，这样在 DNS 端把请求分发到不同的服务器，实现负载均衡。

